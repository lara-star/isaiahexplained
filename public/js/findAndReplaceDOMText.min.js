window.findAndReplaceDOMText=function(){function i(e){return r.call(e)=="[object Array]"}function s(e){return String(e).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function o(){return u.apply(null,arguments)||a.apply(null,arguments)}function u(e,t,n,r,i){if(t&&!t.nodeType&&arguments.length<=2){return false}var s=typeof n=="function";if(s){n=function(e){return function(t,n){return e(t.text,n.startIndex)}}(n)}var u=a(t,{find:e,wrap:s?null:n,replace:s?n:"$"+(r||"&"),prepMatch:function(e,t){if(!e[0])throw"findAndReplaceDOMText cannot handle zero-length matches";if(r>0){var n=e[r];e.index+=e[0].indexOf(n);e[0]=n}e.endIndex=e.index+e[0].length;e.startIndex=e.index;e.index=t;return e},filterElements:i});o.revert=function(){return u.revert()};return true}function a(e,t){return new f(e,t)}function f(t,n){n.portionMode=n.portionMode||e;this.node=t;this.options=n;this.prepMatch=n.prepMatch||this.prepMatch;this.reverts=[];this.matches=this.search();if(this.matches.length){this.processMatches()}}var e="retain";var t="first";var n=document;var r={}.toString;o.Finder=f;f.prototype={search:function(){var e;var t=0;var n=this.options.find;var r=this.getAggregateText();var i=[];n=typeof n==="string"?RegExp(s(n),"g"):n;if(n.global){while(e=n.exec(r)){i.push(this.prepMatch(e,t++))}}else{if(e=r.match(n)){i.push(this.prepMatch(e,0))}}return i},prepMatch:function(e,t){if(!e[0]){throw new Error("findAndReplaceDOMText cannot handle zero-length matches")}e.endIndex=e.index+e[0].length;e.startIndex=e.index;e.index=t;return e},getAggregateText:function(){function t(n){if(n.nodeType===3){return n.data}if(e&&!e(n)){return""}var r="";if(n=n.firstChild)do{r+=t(n)}while(n=n.nextSibling);return r}var e=this.options.filterElements;return t(this.node)},processMatches:function(){var e=this.matches;var t=this.node;var n=this.options.filterElements;var r,i,s=[],o=t,u=e.shift(),a=0,f=0,l=0,c,h=[t];e:while(true){if(o.nodeType===3){if(!i&&o.length+a>=u.endIndex){i={node:o,index:l++,text:o.data.substring(u.startIndex-a,u.endIndex-a),indexInMatch:a-u.startIndex,indexInNode:u.startIndex-a,endIndexInNode:u.endIndex-a,isEnd:true}}else if(r){s.push({node:o,index:l++,text:o.data,indexInMatch:a-u.startIndex,indexInNode:0})}if(!r&&o.length+a>u.startIndex){r={node:o,index:l++,indexInMatch:0,indexInNode:u.startIndex-a,endIndexInNode:u.endIndex-a,text:o.data.substring(u.startIndex-a,u.endIndex-a)}}a+=o.data.length}c=o.nodeType===1&&n&&!n(o);if(r&&i){o=this.replaceMatch(u,r,s,i);a-=i.node.data.length-i.endIndexInNode;r=null;i=null;s=[];u=e.shift();l=0;f++;if(!u){break}}else if(!c&&(o.firstChild||o.nextSibling)){if(o.firstChild){h.push(o);o=o.firstChild}else{o=o.nextSibling}continue}while(true){if(o.nextSibling){o=o.nextSibling;break}o=h.pop();if(o===t){break e}}}},revert:function(){for(var e=this.reverts.length;e--;){this.reverts[e]()}this.reverts=[]},prepareReplacementString:function(e,n,r,i){var s=this.options.portionMode;if(s===t&&n.indexInMatch>0){return""}e=e.replace(/\$(\d+|&|`|')/g,function(e,t){var n;switch(t){case"&":n=r[0];break;case"`":n=r.input.substring(0,r.startIndex);break;case"'":n=r.input.substring(r.endIndex);break;default:n=r[+t]}return n});if(s===t){return e}if(n.isEnd){return e.substring(n.indexInMatch)}return e.substring(n.indexInMatch,n.indexInMatch+n.text.length)},getPortionReplacementNode:function(e,t,r){var i=this.options.replace||"$&";var s=this.options.wrap;if(s&&s.nodeType){var o=n.createElement("div");o.innerHTML=s.outerHTML||(new XMLSerializer).serializeToString(s);s=o.firstChild}if(typeof i=="function"){i=i(e,t,r);if(i&&i.nodeType){return i}return n.createTextNode(String(i))}var u=typeof s=="string"?n.createElement(s):s;i=n.createTextNode(this.prepareReplacementString(i,e,t,r));if(!i.data){return i}if(!u){return i}u.appendChild(i);return u},replaceMatch:function(e,t,r,i){var s=t.node;var o=i.node;var u;var a;if(s===o){var f=s;if(t.indexInNode>0){u=n.createTextNode(f.data.substring(0,t.indexInNode));f.parentNode.insertBefore(u,f)}var l=this.getPortionReplacementNode(i,e);f.parentNode.insertBefore(l,f);if(i.endIndexInNode<f.length){a=n.createTextNode(f.data.substring(i.endIndexInNode));f.parentNode.insertBefore(a,f)}f.parentNode.removeChild(f);this.reverts.push(function(){if(u===l.previousSibling){u.parentNode.removeChild(u)}if(a===l.nextSibling){a.parentNode.removeChild(a)}l.parentNode.replaceChild(f,l)});return l}else{u=n.createTextNode(s.data.substring(0,t.indexInNode));a=n.createTextNode(o.data.substring(i.endIndexInNode));var c=this.getPortionReplacementNode(t,e);var h=[];for(var p=0,d=r.length;p<d;++p){var v=r[p];var m=this.getPortionReplacementNode(v,e);v.node.parentNode.replaceChild(m,v.node);this.reverts.push(function(e,t){return function(){t.parentNode.replaceChild(e.node,t)}}(v,m));h.push(m)}var g=this.getPortionReplacementNode(i,e);s.parentNode.insertBefore(u,s);s.parentNode.insertBefore(c,s);s.parentNode.removeChild(s);o.parentNode.insertBefore(g,o);o.parentNode.insertBefore(a,o);o.parentNode.removeChild(o);this.reverts.push(function(){u.parentNode.removeChild(u);c.parentNode.replaceChild(s,c);a.parentNode.removeChild(a);g.parentNode.replaceChild(o,g)});return g}}};return o}()